import { IImpactGraphNode, ISeverity } from '../model'
import { TreeNode } from '../model/treeNode'
import css from '../components/UI/TreeViewer/TreeViewer.module.css'

import { ReactComponent as UnknownFilled } from '../assets/icons/severity/unknown_filled.svg'
import { ReactComponent as Unknown } from '../assets/icons/severity/unknown.svg'
import { ReactComponent as CriticalFilled } from '../assets/icons/severity/critical_filled.svg'
import { ReactComponent as Critical } from '../assets/icons/severity/critical.svg'
import { ReactComponent as HighFilled } from '../assets/icons/severity/high_filled.svg'
import { ReactComponent as High } from '../assets/icons/severity/high.svg'
import { ReactComponent as MediumFilled } from '../assets/icons/severity/medium_filled.svg'
import { ReactComponent as Medium } from '../assets/icons/severity/medium.svg'
import { ReactComponent as LowFilled } from '../assets/icons/severity/low_filled.svg'
import { ReactComponent as Low } from '../assets/icons/severity/low.svg'

export function getSeverityImage(severity: ISeverity, filled = false): JSX.Element {
	switch (severity) {
		case ISeverity.Unknown:
			return filled ? <UnknownFilled /> : <Unknown />
		case ISeverity.Low:
			return filled ? <LowFilled /> : <Low />
		case ISeverity.Medium:
			return filled ? <MediumFilled /> : <Medium />
		case ISeverity.High:
			return filled ? <HighFilled /> : <High />
		case ISeverity.Critical:
			return filled ? <CriticalFilled /> : <Critical />
	}
}

export function getApplicabilityImg(isApplicable: boolean): JSX.Element {
	if (isApplicable) {
		return (
			<svg
				version="1.1"
				id="Layer_1"
				xmlns="http://www.w3.org/2000/svg"
				xmlnsXlink="http://www.w3.org/1999/xlink"
				x="0px"
				y="0px"
				viewBox="0 0 12 12"
				xmlSpace="preserve"
			>
				<g clipPath="url(#clip0_3919_188486)">
					<path
						d="M13.13 11.1702L7.84001 5.86017C8.04062 5.174 8.05366 4.44662 7.87779 3.7537C7.70192 3.06077 7.34357 2.42762 6.84001 1.92017C6.42569 1.51596 5.92858 1.20649 5.38301 1.01312C4.83743 0.819757 4.25639 0.747105 3.68 0.800173C3.60367 0.805658 3.53061 0.833497 3.46998 0.88019C3.40522 0.921356 3.35872 0.985765 3.34001 1.06018C3.31996 1.13215 3.31996 1.20822 3.34001 1.28018C3.36042 1.35163 3.3982 1.41691 3.44999 1.47019L4.9 2.91019C4.99463 3.0044 5.06944 3.11659 5.12 3.24018C5.16912 3.36421 5.19289 3.49682 5.18998 3.63019C5.19289 3.76356 5.16912 3.89614 5.12 4.02017C5.06809 4.14304 4.99345 4.25498 4.9 4.35016L3.62 5.63019C3.52483 5.72363 3.41285 5.79824 3.28999 5.85016C3.16661 5.90242 3.034 5.92935 2.9 5.92935C2.76601 5.92935 2.63337 5.90242 2.50999 5.85016C2.38713 5.79824 2.27518 5.72363 2.18 5.63019L0.74 4.18018C0.683594 4.12938 0.614466 4.09482 0.539988 4.08017C0.465383 4.05502 0.384611 4.05502 0.310007 4.08017C0.236422 4.1061 0.173228 4.15525 0.129984 4.22019C0.0832907 4.28082 0.0554822 4.35385 0.0499973 4.43018C-0.00176876 5.05608 0.0905845 5.68553 0.319986 6.27017C0.55142 6.85178 0.9142 7.37199 1.37998 7.79016C1.89072 8.2331 2.50376 8.54185 3.16371 8.68851C3.82365 8.83517 4.50972 8.81513 5.15998 8.63019L10.45 13.9302C10.8124 14.2838 11.2987 14.4818 11.805 14.4818C12.3113 14.4818 12.7976 14.2838 13.16 13.9302C13.3381 13.7541 13.4777 13.543 13.57 13.3102C13.669 13.0796 13.7201 12.8312 13.7201 12.5802C13.7201 12.3292 13.669 12.0808 13.57 11.8502C13.4777 11.6174 13.3381 11.4062 13.16 11.2302L13.13 11.1702Z"
						fill="#EA535E"
					/>
				</g>
				<defs>
					<clipPath id="clip0_3919_188486">
						<rect width="13.68" height="13.72" fill="white" transform="translate(0 0.780182)" />
					</clipPath>
				</defs>
			</svg>
		)
	}

	return (
		<svg
			version="1.1"
			id="Layer_1"
			xmlns="http://www.w3.org/2000/svg"
			xmlnsXlink="http://www.w3.org/1999/xlink"
			x="0px"
			y="0px"
			viewBox="0 0 12 12"
			xmlSpace="preserve"
		>
			<g clipPath="url(#clip0_3935_168696)">
				<path
					d="M10.41 13.8384C10.7724 14.192 11.2587 14.39 11.765 14.39C12.2714 14.39 12.7576 14.192 13.12 13.8384C13.2996 13.6624 13.4423 13.4524 13.5397 13.2206C13.6371 12.9887 13.6873 12.7398 13.6873 12.4884C13.6873 12.2369 13.6371 11.988 13.5397 11.7562C13.4423 11.5244 13.2996 11.3143 13.12 11.1384V11.0584L10.12 8.05838L7.37 10.8084L10.41 13.8384Z"
					fill="#3387A1"
				/>
				<path
					d="M7.86998 3.60836C7.69006 2.91539 7.32746 2.28341 6.81999 1.77838C6.40265 1.37852 5.90511 1.07186 5.36034 0.878779C4.81556 0.685694 4.23599 0.61056 3.65999 0.65835C3.58402 0.665448 3.51143 0.693121 3.45 0.738367C3.39055 0.784897 3.34547 0.847294 3.31999 0.91836C3.29483 0.989535 3.29483 1.06719 3.31999 1.13836C3.3326 1.21061 3.36758 1.27707 3.42 1.32836L4.86998 2.76837C4.96461 2.86257 5.03942 2.97477 5.08998 3.09835C5.14252 3.22168 5.16974 3.35432 5.17 3.48837C5.16974 3.62242 5.14252 3.75503 5.08998 3.87835C5.03806 4.00121 4.96342 4.11319 4.86998 4.20837L3.58998 5.48837C3.49577 5.583 3.38358 5.6578 3.26 5.70837C3.13667 5.76091 3.00403 5.7881 2.86998 5.78836C2.73593 5.7881 2.60332 5.76091 2.48 5.70837C2.35714 5.65645 2.24519 5.58181 2.15001 5.48837L0.710008 4.03836C0.653602 3.98756 0.584474 3.953 0.509995 3.93835C0.435391 3.9132 0.354589 3.9132 0.279984 3.93835C0.207672 3.96656 0.145137 4.01522 0.0999918 4.07836C0.0563353 4.13987 0.0319606 4.21296 0.0299845 4.28836C-0.0275449 4.91349 0.0628779 5.54339 0.293931 6.1271C0.524984 6.71081 0.890197 7.23197 1.36 7.64837C1.86581 8.09683 2.47899 8.40686 3.14 8.54837C3.40242 8.60843 3.67078 8.63862 3.93999 8.63836L8.01 4.60836C8.00875 4.27023 7.96164 3.93383 7.86998 3.60836Z"
					fill="#3387A1"
				/>
				<path
					d="M13.34 2.04838C13.2283 1.93704 13.0957 1.84882 12.9499 1.78877C12.804 1.72871 12.6478 1.69799 12.49 1.69838C12.332 1.69572 12.175 1.72541 12.0289 1.78559C11.8827 1.84578 11.7504 1.9352 11.64 2.04838L7.89001 5.79838L5.14001 8.54838L1.01001 12.6084C0.898443 12.719 0.809883 12.8506 0.749451 12.9957C0.689018 13.1407 0.657898 13.2963 0.657898 13.4534C0.657898 13.6105 0.689018 13.7661 0.749451 13.9111C0.809883 14.0561 0.898443 14.1878 1.01001 14.2984C1.11987 14.4129 1.25188 14.5039 1.39801 14.5657C1.54414 14.6276 1.70133 14.6591 1.86002 14.6584C2.01853 14.658 2.17538 14.626 2.32135 14.5642C2.46732 14.5023 2.59946 14.412 2.71002 14.2984L6.79001 10.2184L9.54001 7.46836L13.3 3.70838C13.5172 3.489 13.6423 3.19492 13.6497 2.88633C13.6571 2.57774 13.5463 2.27797 13.34 2.04838Z"
					fill="#3387A1"
				/>
			</g>
			<defs>
				<clipPath id="clip0_3935_168696">
					<rect width="13.69" height="14.01" fill="white" transform="translate(0 0.668365)" />
				</clipPath>
			</defs>
		</svg>
	)
}

export function getResearchImg(): JSX.Element {
	return (
		<svg viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path
				d="M8.5677 2.89211H6.8049V1.21416H8.5677V2.89211ZM13.0555 8.67403L9.95834 3.98313C9.89004 3.8801 9.8528 3.76155 9.85062 3.64017V1.21416H9.93631C10.0244 1.21926 10.1126 1.20736 10.1956 1.17919C10.2786 1.15101 10.3546 1.10717 10.4188 1.05035C10.4831 0.99353 10.5343 0.92494 10.5694 0.848805C10.6044 0.77267 10.6224 0.690601 10.6224 0.607654C10.6224 0.524708 10.6044 0.442639 10.5694 0.366503C10.5343 0.290368 10.4831 0.221779 10.4188 0.164959C10.3546 0.10814 10.2786 0.0642932 10.1956 0.0361213C10.1126 0.00794943 10.0244 -0.00395169 9.93631 0.00115091H5.39956C5.3115 -0.00395169 5.22326 0.00794943 5.14027 0.0361213C5.05729 0.0642932 4.98132 0.10814 4.91704 0.164959C4.85276 0.221779 4.80154 0.290368 4.76652 0.366503C4.73151 0.442639 4.71344 0.524708 4.71344 0.607654C4.71344 0.690601 4.73151 0.77267 4.76652 0.848805C4.80154 0.92494 4.85276 0.99353 4.91704 1.05035C4.98132 1.10717 5.05729 1.15101 5.14027 1.17919C5.22326 1.20736 5.3115 1.21926 5.39956 1.21416H5.48526V3.64017C5.49467 3.76193 5.45922 3.88303 5.38487 3.98313L4.28802 5.61965C5.45805 5.77121 6.53039 6.31524 7.3074 7.15147C8.08442 7.9877 8.51375 9.05979 8.51628 10.1701C8.5212 10.6292 8.44847 11.086 8.30083 11.5236H11.3759C11.7322 11.5239 12.0821 11.4342 12.3888 11.2637C12.6955 11.0932 12.9478 10.8482 13.1191 10.5545C13.293 10.2657 13.379 9.93756 13.3678 9.60589C13.3566 9.27422 13.2485 8.95184 13.0555 8.67403Z"
				fill="#40BE46"
			/>
			<path
				d="M1.48613 10.1885C1.48613 9.78822 1.61241 9.39696 1.84899 9.0642C2.08558 8.73143 2.42183 8.47211 2.81521 8.31905C3.2086 8.16598 3.64143 8.12605 4.05896 8.2043C4.47649 8.28256 4.85995 8.47548 5.16083 8.75866C5.4617 9.04184 5.66647 9.40256 5.74923 9.79518C5.832 10.1878 5.78903 10.5947 5.62577 10.9643C5.46251 11.334 5.18629 11.6498 4.83206 11.8718C4.47783 12.0939 4.06151 12.2121 3.63576 12.2117C3.06562 12.2105 2.51923 11.9968 2.11631 11.6176C1.71339 11.2384 1.48678 10.7245 1.48613 10.1885ZM6.66924 12.0483C7.05396 11.4948 7.26289 10.8496 7.27152 10.1885C7.27152 9.51244 7.05829 8.8516 6.65879 8.2895C6.25929 7.72741 5.69146 7.28931 5.02711 7.0306C4.36276 6.7719 3.63173 6.70421 2.92646 6.83609C2.22119 6.96798 1.57336 7.29352 1.06489 7.77154C0.556421 8.24957 0.210148 8.8586 0.0698617 9.52164C-0.0704249 10.1847 0.00157542 10.8719 0.276758 11.4965C0.55194 12.1211 1.01794 12.6549 1.61584 13.0305C2.21374 13.4061 2.91668 13.6065 3.63576 13.6065C4.34109 13.6114 5.03122 13.4138 5.61401 13.0403L7.48698 14.7988C7.62339 14.9272 7.80809 15 8.00113 15.0014C8.0974 15.0027 8.19293 14.9854 8.2818 14.9505C8.37067 14.9157 8.45097 14.8641 8.51772 14.7988C8.65236 14.6647 8.72736 14.4872 8.72736 14.3028C8.72736 14.1184 8.65236 13.9409 8.51772 13.8068L6.66924 12.0483Z"
				fill="#40BE46"
			/>
		</svg>
	)
}

let globalNodeNumber = 0

export function toTreeNode(impactGraph: IImpactGraphNode): TreeNode {
	globalNodeNumber = 0
	return toTreeNodeHelper(impactGraph)
}

function toTreeNodeHelper(impactGraph: IImpactGraphNode): TreeNode {
	const node = new TreeNode(`${++globalNodeNumber}-${impactGraph.name}`, impactGraph.name)

	if (impactGraph.children === undefined || impactGraph.children.length === 0) {
		node.className = css.redNode
		return node
	}

	impactGraph.children.forEach(child => {
		node.addChild(toTreeNodeHelper(child))
	})
	return node
}
